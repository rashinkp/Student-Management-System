{{!-- <title>{{student.firstName}} {{student.secondName}} Profile</title> --}}
<style>
  .profile-image { width: 150px; height: 150px; border-radius: 50%;
  margin-bottom: 20px; } .profile-container{ margin-top: 20px; display: flex;
  border-radius: 30px; background-color:rgb(225, 225, 225); padding: 20px; }
</style>

<section>
  <div class="container">

    <div class="profile-container">
      <img
        src="/images/student/{{student._id}}.jpg"
        alt="Profile Image"
        class="profile-image"
      />
      <div class="profile-details ms-5">
        <h2>{{student.firstName}} {{student.secondName}}</h2>
        <p>Age: {{student.age}}</p>
        <p>Sex: {{student.sex}}</p>
        <p>Class: {{student.class}}</p>
        <p>Place: {{student.place}}, State: {{student.state}}</p>
        <p>Mobile:{{student.mobile}}</p>
        <p>Email: {{student.email}}</p>
      </div>
      {{#if principal}}
        <div class="profile-actions">
          <a
            href="/principal/edit-student/{{student._id}}"
            class="btn btn-secondary"
            id="editButton"
          >Edit</a>
          <a
            class="btn btn-danger"
            id="removeButton"
            onclick="confirmRemove()"
          >Remove</a>
        </div>
      {{else}}
      {{/if}}
    </div>

    <div class="profile-container">
      <div class="row">
        <div class="col-12">
          <h1 class="text-center">Attendance</h1>
        </div>
        <div class="row">
          <div class="col-12">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Total Days</th>
                  <th scope="col">Present</th>
                  <th scope="col">Percentage</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>{{workingDays}}</td>
                  <td>{{student.attendance.present}}</td>
                  <td id="attendancePercentage">{{student.attendance.percentage}}</td>
                </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="profile-container">
      <div class="row">
        <div class="col-12">
          <h1 class="text-center">Mark</h1>
        </div>
        <div class="row">
          <div class="col-12">
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Subject</th>
                  <th scope="col">Total Mark</th>
                  <th scope="col">Mark</th>
                  <th scope="col">Percentage</th>
                </tr>
              </thead>
              <tbody>
                {{#each totalMark}}
            <tr>
              <th scope="row">{{this.subject}}</th>
              <td>{{this.mark}}</td>
              <td>
                <a href="javascript:void(0);" class="btn btn-primary" onclick="updateValue('subtract', 'marks', 'obtainedMark-{{this._id}}')">-</a>
                <span id="obtainedMark-{{this._id}}">60</span>
                <a href="javascript:void(0);" class="btn btn-primary" onclick="updateValue('add', 'marks', 'obtainedMark-{{this._id}}')">+</a>
              </td>
              <td id="marksPercentage-{{this._id}}">75%</td>
            </tr>
            {{/each}}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>

<script>
  function confirmRemove() { var result = confirm("Are you sure you want toremove this student?"); if (result) { window.location.href ="/principal/remove-student/{{student._id}}"; } }
    function updateValue(operation, type, elementId) {
    // Get the current value
    var currentValue = parseInt(document.getElementById(elementId).innerText);

    // Update the value based on the operation
    if (operation === 'add') {
      currentValue += 1;
    } else if (operation === 'subtract' && currentValue > 0) {
      currentValue -= 1;
    }

    // Update the element with the new value
    document.getElementById(elementId).innerText = currentValue;

    // Update percentage if applicable
    updatePercentage(type);
  }

  // Function to update percentage
  function updatePercentage(type) {
    var totalDays = parseInt(document.getElementById('totalDays').innerText);
    var presentDays = parseInt(document.getElementById('presentDays').innerText);
    var totalMark = parseInt(document.getElementById('totalMark').innerText);
    var obtainedMark = parseInt(document.getElementById('obtainedMark').innerText);

    var percentageElement;
    if (type === 'attendance') {
      percentageElement = document.getElementById('attendancePercentage');
      percentageElement.innerText = ((presentDays / totalDays) * 100).toFixed(2) + '%';
    } else if (type === 'marks') {
      percentageElement = document.getElementById('marksPercentage');
      percentageElement.innerText = ((obtainedMark / totalMark) * 100).toFixed(2) + '%';
    }
  }
</script>